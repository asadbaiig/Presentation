<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture-Based Re-engineering</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overflow: hidden;
        }
        
        .presentation {
            width: 100vw;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .slide {
            width: 90%;
            max-width: 1200px;
            height: 85vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 60px;
            display: none;
            flex-direction: column;
            overflow-y: auto;
        }
        
        .slide.active {
            display: flex;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        h1 {
            color: #667eea;
            font-size: 3em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        h2 {
            color: #764ba2;
            font-size: 2.2em;
            margin-bottom: 25px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }
        
        h3 {
            color: #667eea;
            font-size: 1.6em;
            margin: 20px 0 15px 0;
        }
        
        p, li {
            font-size: 1.2em;
            line-height: 1.6;
            color: #333;
            margin-bottom: 15px;
        }
        
        ul {
            margin-left: 30px;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            font-size: 1.3em;
            margin-bottom: 30px;
        }
        
        .authors {
            text-align: center;
            color: #888;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        
        .diagram {
            background: #f8f9fa;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .box {
            display: inline-block;
            padding: 15px 30px;
            background: #667eea;
            color: white;
            border-radius: 8px;
            margin: 10px;
            font-weight: bold;
        }
        
        .arrow {
            font-size: 2em;
            color: #764ba2;
            margin: 0 10px;
        }
        
        .controls {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
            z-index: 1000;
        }
        
        button {
            padding: 15px 30px;
            font-size: 1.1em;
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            color: #667eea;
        }
        
        button:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .slide-counter {
            position: fixed;
            top: 20px;
            right: 30px;
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            color: #667eea;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 3px 8px;
            border-radius: 4px;
        }
        
        .code-box {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }
        
        .metric {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 10px;
        }
        
        .metric-number {
            font-size: 3em;
            font-weight: bold;
        }
        
        .metric-label {
            font-size: 1.1em;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="presentation">
        <!-- Slide 1: Title -->
        <div class="slide active">
            <h1>Re-engineering to Enforce Architectural Control Flow and Data Sharing</h1>
            <p class="subtitle">A Case Study using ArchJava and AliasJava</p>
            <div class="authors">
                <p>Marwan Abi-Antoun, Jonathan Aldrich, Wesley Coelho</p>
                <p>Carnegie Mellon University & University of British Columbia</p>
            </div>
            <div class="diagram">
                <div class="box">Legacy Java Code</div>
                <span class="arrow">→</span>
                <div class="box">ArchJava + AliasJava</div>
                <span class="arrow">→</span>
                <div class="box">Enforced Architecture</div>
            </div>
        </div>

        <!-- Slide 2: The Problem -->
        <div class="slide">
            <h2>The Problem: Architectural Drift</h2>
            <h3>What Goes Wrong?</h3>
            <ul>
                <li>Software architecture exists in documentation, <span class="highlight">separate from code</span></li>
                <li>Developers rarely consult external documentation</li>
                <li>Over time, implementation <span class="highlight">drifts</span> from original architecture</li>
                <li>Architecture documentation becomes inaccurate and unusable</li>
            </ul>
            <h3>Consequences</h3>
            <ul>
                <li><strong>Architectural Drift:</strong> Loss of clarity and coherence</li>
                <li><strong>Architectural Erosion:</strong> Violations leading to brittleness</li>
                <li>Increased complexity and difficulty in maintenance</li>
            </ul>
        </div>

        <!-- Slide 3: The Solution -->
        <div class="slide">
            <h2>The Solution: Embedded Architecture</h2>
            <h3>ArchJava: Architecture in Code</h3>
            <ul>
                <li>Component-and-Connector architecture <span class="highlight">embedded in Java code</span></li>
                <li>Enforces <strong>communication integrity</strong> through type system</li>
                <li>Components can only communicate if explicitly connected</li>
            </ul>
            <h3>AliasJava: Data Sharing Control</h3>
            <ul>
                <li>Annotation system for expressing how data is shared</li>
                <li><strong>Ownership domains</strong> group related objects</li>
                <li>Controls aliasing between components</li>
            </ul>
            <div class="diagram">
                <p style="font-size: 1.3em; color: #667eea; font-weight: bold;">Architecture = Control Flow + Data Sharing</p>
            </div>
        </div>

        <!-- Slide 4: Case Study Subject -->
        <div class="slide">
            <h2>Case Study: HillClimber Application</h2>
            <div class="two-column">
                <div>
                    <h3>About HillClimber</h3>
                    <ul>
                        <li>Part of CIspace educational tools</li>
                        <li>Demonstrates AI search algorithms</li>
                        <li>Maintained by multiple student developers</li>
                        <li>Architecture lost over time</li>
                    </ul>
                </div>
                <div>
                    <h3>System Size</h3>
                    <div class="metric">
                        <div class="metric-number">16,000</div>
                        <div class="metric-label">Lines of Code</div>
                    </div>
                    <div class="metric">
                        <div class="metric-number">92</div>
                        <div class="metric-label">Classes</div>
                    </div>
                </div>
            </div>
            <p><strong>Challenge:</strong> Structure degraded into arbitrary communication paths with little organization</p>
        </div>

        <!-- Slide 5: Re-engineering Process -->
        <div class="slide">
            <h2>The Re-engineering Process</h2>
            <div style="margin: 30px 0;">
                <div class="box" style="display: block; margin: 15px auto; width: fit-content;">1. Identify Source Architecture</div>
                <div style="text-align: center; font-size: 2em; color: #764ba2;">↓</div>
                <div class="box" style="display: block; margin: 15px auto; width: fit-content;">2. Identify Target Architecture</div>
                <div style="text-align: center; font-size: 2em; color: #764ba2;">↓</div>
                <div class="box" style="display: block; margin: 15px auto; width: fit-content;">3. Analyze Original Program</div>
                <div style="text-align: center; font-size: 2em; color: #764ba2;">↓</div>
                <div class="box" style="display: block; margin: 15px auto; width: fit-content;">4. Restructure in Java</div>
                <div style="text-align: center; font-size: 2em; color: #764ba2;">↓</div>
                <div class="box" style="display: block; margin: 15px auto; width: fit-content;">5. Convert to ArchJava</div>
                <div style="text-align: center; font-size: 2em; color: #764ba2;">↓</div>
                <div class="box" style="display: block; margin: 15px auto; width: fit-content;">6. Add AliasJava Annotations</div>
            </div>
        </div>

        <!-- Slide 6: ArchJava Components -->
        <div class="slide">
            <h2>ArchJava: Key Concepts</h2>
            <h3>Components</h3>
            <ul>
                <li>Special objects with explicit communication patterns</li>
                <li>Defined using <code>component class</code></li>
            </ul>
            <h3>Ports</h3>
            <ul>
                <li>Communication endpoints on components</li>
                <li>Declare <strong>required</strong> and <strong>provided</strong> methods</li>
            </ul>
            <h3>Connections</h3>
            <ul>
                <li>Explicit links between component ports</li>
                <li>Enforces allowed communication patterns</li>
            </ul>
            <div class="code-box">
public component class Transform {
    public port in {
        provides void draw(Shape s);
    }
    public port out {
        requires void draw(Shape s);
    }
}
            </div>
        </div>

        <!-- Slide 7: AliasJava Concepts -->
        <div class="slide">
            <h2>AliasJava: Ownership Domains</h2>
            <h3>Key Annotations</h3>
            <div class="two-column">
                <div>
                    <p><strong>owned:</strong> Private internal objects</p>
                    <p><strong>shared:</strong> Globally accessible objects</p>
                    <p><strong>unique:</strong> Single reference ownership</p>
                </div>
                <div>
                    <p><strong>lent:</strong> Temporary access</p>
                    <p><strong>Domain parameters:</strong> Controlled sharing</p>
                </div>
            </div>
            <div class="code-box">
class Sequence&lt;Towner&gt; {
    domain owned;           // Private domain
    public domain iters;    // Public domain
    
    owned Cons head;        // Internal representation
    iters Iterator getIter() { ... }
}
            </div>
            <p style="margin-top: 20px;"><strong>Benefit:</strong> Prevents unauthorized access to internal data structures</p>
        </div>

        <!-- Slide 8: Restructuring Steps -->
        <div class="slide">
            <h2>Key Restructuring Steps</h2>
            <h3>1. Encapsulation</h3>
            <p>All component fields must be private/protected with accessors</p>
            
            <h3>2. Remove Navigation Code</h3>
            <p>Replace: <code>getCanvas().getGraph().setWidth(...)</code></p>
            <p>With: <code>graph.setWidth(...)</code></p>
            
            <h3>3. Eliminate Component References as Arguments</h3>
            <p>Replace constructor parameters with ports and connections</p>
            
            <h3>4. Separate Initialization</h3>
            <p>Move initialization out of constructors into <code>init()</code> methods called after connections established</p>
        </div>

        <!-- Slide 9: Results - Effort -->
        <div class="slide">
            <h2>Effort Required</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin: 30px 0;">
                <div class="metric">
                    <div class="metric-label">Restructuring Java</div>
                    <div class="metric-number">15%</div>
                    <div class="metric-label">of code changed</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Adding ArchJava</div>
                    <div class="metric-number">15%</div>
                    <div class="metric-label">of code changed</div>
                </div>
                <div class="metric">
                    <div class="metric-label">Adding AliasJava</div>
                    <div class="metric-number">20%</div>
                    <div class="metric-label">of code changed</div>
                </div>
            </div>
            <h3>Total Estimated Effort</h3>
            <p style="text-align: center; font-size: 1.5em; color: #667eea; font-weight: bold;">~40 hours (with experience)</p>
            <p style="text-align: center;">Excludes learning time and assumes annotated standard library</p>
        </div>

        <!-- Slide 10: Annotation Statistics -->
        <div class="slide">
            <h2>AliasJava Annotation Distribution</h2>
            <h3>Field Annotations</h3>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <p>• <strong>45% owned</strong> - Private internal objects</p>
                <p>• <strong>34% shared</strong> - Globally accessible</p>
                <p>• <strong>10% data domain</strong> - Model tier</p>
                <p>• <strong>6% logic domain</strong> - Business logic</p>
                <p>• <strong>4% UI domain</strong> - User interface</p>
            </div>
            <h3>Variable/Parameter Annotations</h3>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                <p>• <strong>69% lent</strong> - Temporary references (default)</p>
                <p>• <strong>14% shared</strong> - Global access</p>
                <p>• <strong>16% data domain</strong> - Model objects</p>
            </div>
        </div>

        <!-- Slide 11: Benefits -->
        <div class="slide">
            <h2>Benefits of the Approach</h2>
            <h3>✓ Explicit Architecture</h3>
            <p>Architecture is visible in source code, not external documents</p>
            
            <h3>✓ Enforced Communication</h3>
            <p>Type system prevents violations of architectural constraints</p>
            
            <h3>✓ Better Documentation</h3>
            <p>Code itself documents both control flow and data sharing</p>
            
            <h3>✓ Prevents Future Drift</h3>
            <p>Changes must respect architecture or explicitly modify it</p>
            
            <h3>✓ Highlighted Refactoring Opportunities</h3>
            <p>Adding annotations revealed design smells not visible from control flow alone</p>
        </div>

        <!-- Slide 12: Challenges -->
        <div class="slide">
            <h2>Challenges & Limitations</h2>
            <h3>Tool Support Issues</h3>
            <ul>
                <li>No refactoring support once in ArchJava</li>
                <li>Limited debugging capabilities</li>
                <li>Some errors only caught at runtime</li>
            </ul>
            <h3>Language Limitations</h3>
            <ul>
                <li>Cannot incrementally add annotations easily</li>
                <li>Heavyweight annotation system</li>
                <li>Missing port types and directionality</li>
                <li>Inheritance/subtyping not separated</li>
            </ul>
            <h3>Practical Concerns</h3>
            <ul>
                <li>Significant manual effort required</li>
                <li>Must annotate entire system for full benefit</li>
            </ul>
        </div>

        <!-- Slide 13: Lessons Learned -->
        <div class="slide">
            <h2>Key Lessons Learned</h2>
            <div class="diagram" style="text-align: left;">
                <h3>1. Keep It Iterative</h3>
                <p>Irreversible transformations increase complexity</p>
                
                <h3>2. Keep It Incremental</h3>
                <p>Ability to gradually convert system is invaluable</p>
                
                <h3>3. Tolerate Incompleteness</h3>
                <p>Allow running system while architecture is incomplete</p>
                
                <h3>4. Automate When Possible</h3>
                <p>Many transformations could be tool-supported</p>
                
                <h3>5. Use Annotations as Metrics</h3>
                <p>Unexpected domain parameters reveal design problems</p>
            </div>
        </div>

        <!-- Slide 14: Conclusions -->
        <div class="slide">
            <h2>Conclusions</h2>
            <h3>Key Contributions</h3>
            <ul>
                <li>Demonstrated re-engineering to enforce <span class="highlight">both control flow and data sharing</span></li>
                <li>Largest case study to date with ownership types on real system</li>
                <li>Documented process and challenges for future work</li>
            </ul>
            <h3>Future Directions</h3>
            <ul>
                <li>Better tool support needed for adoption</li>
                <li>Automated inference of annotations</li>
                <li>Support for partial/incremental annotation</li>
                <li>Empirical evaluation of maintenance benefits</li>
            </ul>
            <div class="diagram">
                <p style="font-size: 1.4em; color: #667eea; font-weight: bold;">
                    "Architecture should be part of the code,<br>not separate from it"
                </p>
            </div>
        </div>

        <!-- Slide 15: Q&A -->
        <div class="slide">
            <h1>Questions?</h1>
            <div style="text-align: center; margin-top: 60px;">
                <div class="diagram">
                    <h3 style="color: #667eea; margin-bottom: 30px;">Key Takeaways</h3>
                    <div style="text-align: left; font-size: 1.2em;">
                        <p>✓ Embedded architectures prevent drift</p>
                        <p>✓ 16,000 LOC system successfully re-engineered</p>
                        <p>✓ ~40 hours effort with proper tools</p>
                        <p>✓ Both control flow AND data sharing matter</p>
                        <p>✓ Tool support needs improvement</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="slide-counter">
        <span id="current">1</span> / <span id="total">15</span>
    </div>

    <div class="controls">
        <button id="prev">← Previous</button>
        <button id="next">Next →</button>
    </div>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const totalSlides = slides.length;
        
        document.getElementById('total').textContent = totalSlides;
        
        // Ensure an initial active slide is shown even if the class is missing
        if (totalSlides > 0 && !document.querySelector('.slide.active')) {
            slides[0].classList.add('active');
        }
        // Sync the counter on load
        document.getElementById('current').textContent = (Array.from(slides).findIndex(s => s.classList.contains('active')) + 1) || 1;
        
        function showSlide(n) {
            if (totalSlides === 0) return;
            slides[currentSlide].classList.remove('active');
            currentSlide = (n + totalSlides) % totalSlides;
            slides[currentSlide].classList.add('active');
            document.getElementById('current').textContent = currentSlide + 1;
        }
        
        document.getElementById('next').addEventListener('click', () => {
            showSlide(currentSlide + 1);
        });
        
        document.getElementById('prev').addEventListener('click', () => {
            showSlide(currentSlide - 1);
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight' || e.key === ' ') {
                showSlide(currentSlide + 1);
            } else if (e.key === 'ArrowLeft') {
                showSlide(currentSlide - 1);
            }
        });
    </script>
</body>
</html>